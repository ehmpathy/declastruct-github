# phase 3 execution: public exports

## overview

this document tracks the execution of phase 3 from the blueprint at `.behaviors/v2025_11_23.declastruct-interface/3.3.blueprint.v1.i1.md`

**objective**: update package exports to expose the declastruct provider interface via the public SDK

## implementation summary

### 1. created src/contract/sdks directory structure

created directory `src/contract/sdks/` to house public SDK exports following the repo's layered architecture pattern

### 2. implemented public exports file

**file**: `src/contract/sdks/index.ts`

**what**: public SDK exports for declastruct-github package

**implementation details**:
- exports `getDeclastructGithubProvider` function from `domain.operations/provider`
- exports `DeclastructGithubProvider` type from `domain.objects`
- exports all four domain object classes: `DeclaredGithubRepo`, `DeclaredGithubBranch`, `DeclaredGithubRepoConfig`, `DeclaredGithubBranchProtection`
- uses type-only export for `DeclastructGithubProvider` to avoid runtime import errors

**key code patterns**:
```typescript
// provider
export { getDeclastructGithubProvider } from '../../domain.operations/provider/getDeclastructGithubProvider';
export type { DeclastructGithubProvider } from '../../domain.objects/DeclastructGithubProvider';

// domain objects
export { DeclaredGithubRepo } from '../../domain.objects/DeclaredGithubRepo';
export { DeclaredGithubBranch } from '../../domain.objects/DeclaredGithubBranch';
export { DeclaredGithubRepoConfig } from '../../domain.objects/DeclaredGithubRepoConfig';
export { DeclaredGithubBranchProtection } from '../../domain.objects/DeclaredGithubBranchProtection';
```

### 3. updated package.json main field

**file**: `package.json`

**changes**:
- updated `"main"` field from `"dist/index.js"` to `"dist/contract/sdks/index.js"`
- this ensures npm consumers receive the declastruct provider interface as the package entry point

**before**:
```json
"main": "dist/index.js"
```

**after**:
```json
"main": "dist/contract/sdks/index.js"
```

## issues encountered and resolved

### issue 1: DeclastructGithubProvider export location
**problem**: initially tried to export `DeclastructGithubProvider` from the provider file, but it's defined in domain.objects
**resolution**: updated export to reference the correct location: `domain.objects/DeclastructGithubProvider`
**fix**: used `export type { DeclastructGithubProvider }` to import from domain.objects

## verification

### typescript compilation
ran `npx tsc -p ./tsconfig.build.json --noEmit` - compilation passed successfully with no errors

### build output
ran `npm run build` - successfully generated:
- `dist/contract/sdks/index.js` (compiled JavaScript)
- `dist/contract/sdks/index.d.ts` (TypeScript definitions)
- `dist/contract/sdks/index.js.map` (source map)

### code style compliance
all implementations follow mechanic role standards:
- .what and .why jsdoc comments on file header
- proper layered architecture (contract → domain.operations + domain.objects)
- clean, organized exports grouped by purpose

## phase 3 completion

✅ public exports file created at `src/contract/sdks/index.ts`
✅ package.json main field updated to `dist/contract/sdks/index.js`
✅ typescript compilation verified
✅ package build verified

phase 3 is complete and the package is ready for consumption via npm

## next steps

phase 4: integration tests (validate provider interface works with declastruct)
phase 5: acceptance tests (validate CLI workflow via shell invocation)
