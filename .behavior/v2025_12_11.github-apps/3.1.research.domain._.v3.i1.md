# Research: GitHub App Ownership & Multi-Org Sharing

## Question

Does each organization have to create a new GitHub App? Or are apps reusable across organizations (one org creates, other orgs install)? What are the security profiles of each option?

---

## Answer Summary

**Apps ARE reusable across organizations** - but the sharing model depends on the app's visibility setting and whether you're using GitHub Enterprise.

| Ownership Model | Who Can Install | Security Profile | Use Case |
|-----------------|-----------------|------------------|----------|
| **Private App** | Only the owning account/org | Highest isolation | Single org internal tools |
| **Public App** | Anyone on GitHub | Lowest isolation | Open source tools, marketplace apps |
| **Enterprise App** | Only orgs within the enterprise | Enterprise-scoped isolation | Multi-org companies on Enterprise Cloud |

---

## Option 1: Private App (Single Org)

> [1] "If you set your GitHub App registration to private, it can only be installed on the account that owns the app." - [Making a GitHub App public or private](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/making-a-github-app-public-or-private)

**Pros:**
- Maximum isolation - no external access
- Credentials stay within one organization
- Simpler security model

**Cons:**
- Cannot share across multiple organizations
- Must duplicate app for each org (multiple private keys, app IDs)

**Security Profile:** HIGHEST
- Attack surface limited to single organization
- Compromised credentials affect only one org
- No supply chain risk from shared ownership

---

## Option 2: Public App (Multi-Org via Public Install)

> [2] "If you set your GitHub App registration to public, any user on GitHub can install it and authorize it." - [Making a GitHub App public or private](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/making-a-github-app-public-or-private)

**How It Works:**
- One organization creates and owns the app
- App is marked "public"
- Any GitHub user/org can install it
- Each installation gets its own installation ID and scoped access

> [3] "A single installation has access to repositories only from a specific user or organization. A GitHub app can be installed in multiple orgs, but it is only possible to be authenticated with a single org at a time." - [GitHub Community Discussion](https://github.com/orgs/community/discussions/24549)

**Pros:**
- Single app, single private key to manage
- Easy sharing across organizations
- Installation-level isolation (each org's data separate)

**Cons:**
- App metadata (name, description) publicly visible
- Anyone can install (though permissions still controlled by installer)
- App owner can push permission updates affecting all installations

> [4] "Permission updates have the potential for impact if a developer/admin was reliant on the app not being updated in a specific organization. Auto-update behavior is being debated for app managers, as it can be used to effectively escalate privilege within every organization where the app is installed." - [GitHub Community Discussion](https://github.com/orgs/community/discussions/7439)

**Security Profile:** MEDIUM
- Credential compromise affects all installing orgs
- Supply chain risk: malicious owner could escalate permissions
- Public visibility may leak internal tool names/purposes

---

## Option 3: Enterprise-Owned App (Enterprise Cloud Only)

> [5] "Enterprise-owned GitHub Apps are applications that enterprise owners can create and maintain for exclusive use within their enterprise. These apps have access restricted to just the organizations and members in the enterprise." - [GitHub Changelog](https://github.blog/changelog/2024-10-22-enterprises-can-create-github-apps-for-use-within-the-enterprise/)

**Released:** October 22, 2024 (Public Beta), March 2025 (GA)

**How It Works:**
- Created at enterprise level (not org level)
- Can be installed by any org within the enterprise
- Cannot be installed outside the enterprise
- Internal visibility (not public)

> [6] "When users or organizations leave the enterprise, they immediately lose access to enterprise-owned apps. The apps simultaneously lose access to departing users and organizations." - [GitHub Changelog](https://github.blog/changelog/2024-10-22-enterprises-can-create-github-apps-for-use-within-the-enterprise/)

**Pros:**
- Single app across all enterprise orgs
- Private/internal visibility (not exposed to github.com)
- Automatic access revocation when leaving enterprise
- Enterprise-level credential management

**Cons:**
- Requires GitHub Enterprise Cloud
- Enterprise owner must create/manage apps
- Not available for non-enterprise users

**Security Profile:** HIGH
- Enterprise-scoped isolation
- Automatic offboarding when orgs/users leave
- No public exposure
- Centralized management

---

## Security Risks of Shared Apps

### Risk 1: Credential Compromise Blast Radius

> [7] "In the CircleCI breach, the inciting incident was a compromised GitHub token... Hackers stole tokens from CircleCI production systems and leveraged these non-human identities to gain unauthorized access to the GitHub tenants of CircleCI's customers." - [Arnica Blog](https://www.arnica.io/blog/how-to-protect-yourself-against-github-oauth-apps-supply-chain-attacks)

**Impact by Model:**
- Private App: Only owning org affected
- Public App: ALL installing orgs potentially affected
- Enterprise App: All enterprise orgs potentially affected

### Risk 2: Permission Escalation

> [8] "A bug in GitHub existed for about five days... that allowed third-party applications connected to GitHub to generate new scoped installation tokens with elevated permissions. For example, if you connected the Codecov app to your GitHub account with read-only access to your repositories, during that window the app could have created a new token with write access." - [Aqua Security Blog](https://www.aquasec.com/blog/github-app-tokens/)

### Risk 3: Supply Chain Attack

> [9] "GitHub application exploitation is yet another software supply chain attack vector to compromise multiple organizations rapidly, and there is no code dependency or hardened CI/CD pipeline that will mitigate this risk." - [Astrix Security](https://astrix.security/learn/blog/github-apps-bug-created-significant-3rd-party-risk-how-you-can-stay-protected/)

### Risk 4: Shadow Integrations

> [10] "33% of the active access tokens connecting GitHub and third-party apps are unused. 74% of Personal Access Tokens in GitHub environments have no expiration, and 59% of the webhooks in GitHub are misconfigured." - [Arnica Blog](https://www.arnica.io/blog/how-to-protect-yourself-against-github-oauth-apps-supply-chain-attacks)

---

## Recommendations

### For Single Organization

**Use: Private App**

```
Organization: ehmpathy
└── GitHub App: declastruct-github (private)
    ├── APP_ID: stored in org vars
    └── PRIVATE_KEY: stored in org secrets
```

- Maximum isolation
- Simplest security model
- No external dependencies

### For Multiple Related Organizations (Same Company)

**Use: Enterprise App (if on Enterprise Cloud)**

```
Enterprise: ehmpathy-enterprise
├── GitHub App: declastruct-github (enterprise-owned)
├── Organization: ehmpathy
│   └── Installation: declastruct-github
├── Organization: ehmpathy-labs
│   └── Installation: declastruct-github
└── Organization: ehmpathy-oss
    └── Installation: declastruct-github
```

- Single app, single set of credentials
- Enterprise-scoped isolation
- Automatic access management

**Use: Public App (if not on Enterprise Cloud)**

```
Organization: ehmpathy (owner)
└── GitHub App: declastruct-github (public)
    ├── Installation on: ehmpathy
    ├── Installation on: ehmpathy-labs
    └── Installation on: ehmpathy-oss
```

- Single app to manage
- Accept public visibility tradeoff
- Each installation isolated from others

**Alternative: Multiple Private Apps**

```
Organization: ehmpathy
└── GitHub App: declastruct-github-ehmpathy (private)

Organization: ehmpathy-labs
└── GitHub App: declastruct-github-labs (private)

Organization: ehmpathy-oss
└── GitHub App: declastruct-github-oss (private)
```

- Maximum isolation
- More management overhead (3 private keys, 3 app IDs)
- No cross-org credential sharing risk

---

## Decision Matrix

| Factor | Private (per-org) | Public (shared) | Enterprise (shared) |
|--------|-------------------|-----------------|---------------------|
| **Credential management** | Multiple keys | Single key | Single key |
| **Blast radius** | 1 org | All installers | Enterprise orgs |
| **Visibility** | Hidden | Public | Internal |
| **Setup complexity** | Per-org setup | One-time | One-time |
| **Requires Enterprise** | No | No | Yes |
| **Supply chain risk** | None | Owner can escalate | Enterprise owner can escalate |
| **Recommended for** | High security | Convenience | Enterprise multi-org |

---

## For declastruct-github Wish

Based on the wish to provision apps for `declastruct-github` and `please-release`:

**If single org (ehmpathy only):**
- Create 2 private apps in ehmpathy org
- Store credentials in ehmpathy secrets/vars

**If multiple orgs (ehmpathy ecosystem):**
- If Enterprise Cloud: Create 2 enterprise-owned apps
- If not Enterprise: Either:
  - Create 2 public apps (owned by ehmpathy, installed by others)
  - Create 2 private apps per org (more overhead, more isolation)

---

## Citations

1. [Making a GitHub App public or private](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/making-a-github-app-public-or-private) - Private app definition
2. [Making a GitHub App public or private](https://docs.github.com/en/apps/creating-github-apps/registering-a-github-app/making-a-github-app-public-or-private) - Public app definition
3. [GitHub Community Discussion #24549](https://github.com/orgs/community/discussions/24549) - Installation isolation
4. [GitHub Community Discussion #7439](https://github.com/orgs/community/discussions/7439) - Permission escalation concern
5. [GitHub Changelog 2024-10-22](https://github.blog/changelog/2024-10-22-enterprises-can-create-github-apps-for-use-within-the-enterprise/) - Enterprise apps introduction
6. [GitHub Changelog 2024-10-22](https://github.blog/changelog/2024-10-22-enterprises-can-create-github-apps-for-use-within-the-enterprise/) - Enterprise access revocation
7. [Arnica Blog](https://www.arnica.io/blog/how-to-protect-yourself-against-github-oauth-apps-supply-chain-attacks) - CircleCI breach
8. [Aqua Security Blog](https://www.aquasec.com/blog/github-app-tokens/) - Permission escalation bug
9. [Astrix Security](https://astrix.security/learn/blog/github-apps-bug-created-significant-3rd-party-risk-how-you-can-stay-protected/) - Supply chain attack vector
10. [Arnica Blog](https://www.arnica.io/blog/how-to-protect-yourself-against-github-oauth-apps-supply-chain-attacks) - Shadow integration stats
